#ëŒ€ë¶„ë¥˜/ì¤‘ë¶„ë¥˜ ì…ë ¥ë°›ëŠ” í•¨ìˆ˜
def business_filter():
    
    # 1. ëŒ€ë¶„ë¥˜ëª… ëª©ë¡ ì¶œë ¥
    print('ğŸ“ ì—…ì¢… ë¦¬ìŠ¤íŠ¸','>>',np.unique(business['ëŒ€ë¶„ë¥˜ëª…']))
    print()

    # 2. ëŒ€ë¶„ë¥˜ ì…ë ¥ ë°›ê¸°
    category = input('ğŸ§¡ ì–´ë–¤ ë¶„ì•¼ì˜ ì°½ì—…ì„ ì›í•˜ì‹œë‚˜ìš”? ë¦¬ìŠ¤íŠ¸ì—ì„œ ê·¸ëŒ€ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”:')

    # 3. ì¤‘ë¶„ë¥˜ëª… ëª©ë¡ ì¶œë ¥
    category_list = np.unique(business[business['ëŒ€ë¶„ë¥˜ëª…'] == category]['ì¤‘ë¶„ë¥˜ëª…'])

    # 2-1. ì…ë ¥í•œ ëŒ€ë¶„ë¥˜ì— ì¤‘ë¶„ë¥˜ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ëŒ€ë¶„ë¥˜ë¥¼ ì˜ëª» ì…ë ¥í–ˆë‹¤ê³  íŒë‹¨
    while not np.any(category_list):
        print('í•´ë‹¹í•˜ëŠ” ì—…ì¢… ëŒ€ë¶„ë¥˜ê°€ ì—†ìŠµë‹ˆë‹¤.\n')
        category = input('ì¡°íšŒí•  ì—…ì¢…ì˜ ëŒ€ë¶„ë¥˜ëª…ì„ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”: \n')
        category_list = np.unique(business[business['ëŒ€ë¶„ë¥˜ëª…'] == category]['ì¤‘ë¶„ë¥˜ëª…'])

    print()
    print('\nğŸ“ ì„¸ë¶€ ì—…ì¢… ë¦¬ìŠ¤íŠ¸', '>>',category_list)
    print()


    # 4. ì¤‘ë¶„ë¥˜ ì…ë ¥ ë°›ê¸°
    final_category = input('ğŸ§¡ ì°½ì—…í•˜ê³  ì‹¶ì€ {}ì˜ ì„¸ë¶€ ì—…ì¢…ì„ ê·¸ëŒ€ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”:'.format(category))

    # 4-1. ì…ë ¥í•œ ì¤‘ë¶„ë¥˜ê°€ í•´ë‹¹ ëŒ€ë¶„ë¥˜ëª…ì´ ê°€ì§€ê³  ìˆëŠ” ë¦¬ìŠ¤íŠ¸ì— ì—†ìœ¼ë©´ ì˜ëª» ì…ë ¥í–ˆë‹¤ê³  íŒë‹¨
    while final_category not in category_list:
        final_category = input('ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”: ')

    # 4-2. ì¤‘ë¶„ë¥˜ ì½”ë“œ ì €ì¥
    category_code=np.unique(business[business['ì¤‘ë¶„ë¥˜ëª…']==final_category]['ì¤‘ë¶„ë¥˜ì½”ë“œ'])[0]

    # 5. ì…ë ¥í•œ ê°’(ì¤‘ë¶„ë¥˜ëª…)ì„ final_categoryë¡œ ë°›ì•„ë‘ê³ , ë‹¤ìŒ ë¸”ë£¨ì˜¤ì…˜ í•„í„°ë§ì—ì„œ ê²€ìƒ‰ì–´ë¡œ í™œìš©í•œë‹¤.
    

    # 6. í”„ë¡œê·¸ë¨ ê²°ê³¼ ì¶œë ¥
    print('\n...\n...','\n ì„œìš¸ì‹œë‚´ {} ë¸”ë£¨ì˜¤ì…˜ ì°¾ê¸°ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.'.format(final_category))

    return final_category, category, category_code



  # ë¸”ë£¨ì˜¤ì…˜ í•„í„°ë§ í•¨ìˆ˜ bluefilterì •ì˜

def bluefilter(category, df_bus, df_dongpeo, final_category_kor): #ì „ì²˜ë¦¬í•œ ë°ì´í„°ì™€, ì…ë ¥ë°›ì€ ì—…ì¢…(category)ë¥¼ ë°›ì•„ ì‚¬ìš©í•©ë‹ˆë‹¤

  # í•„ìš”í•œ ë°ì´í„° ì •ì˜
  #1. filtered_data : íŠ¹ì • ì—…ì¢…ì„ ê°€ì§„ ìƒê¶Œ ë°ì´í„°ë¥¼ ë¶„ë¦¬í•´ë‚¸ ë°ì´í„°
  # ì…ë ¥í•œ ì—…ì¢…ì½”ë“œì— í•´ë‹¹í•˜ëŠ” ìƒê¶Œì„ filtered_dataì— ë„£ì–´ì¤€ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í•œì‹(ì½”ë“œ I201)ì„ ì…ë ¥í–ˆì„ ê²½ìš°, í•œì‹ì—…ì¢… ê°€ê²Œë§Œ ë‹´ì€ ë°ì´í„°ê°€ ë¨
  filtered_data = df_bus[df_bus['ìƒê¶Œì—…ì¢…ì¤‘ë¶„ë¥˜ì½”ë“œ'] == category].copy() 
 
 # dong_codesëŠ” íŠ¹ì • ì—…ì¢… ìƒê¶Œì„ ê°€ì§„ í–‰ì •ë™ì˜ ì½”ë“œë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ë„£ì€ ê²ƒ.
  dong_codes = list(set(filtered_data['í–‰ì •ë™ì½”ë“œ'])) 
 
  #2. df_filtered_dongpeo : ìƒí™œì¸êµ¬ ë°ì´í„°ì—ì„œ íŠ¹ì • ì—…ì¢… ìƒê¶Œì„ ê°€ì§„ í–‰ì •ë™ì— í•´ë‹¹í•˜ëŠ” ìƒí™œì¸êµ¬ ë°ì´í„°ë§Œì„ ë½‘ê¸° ìœ„í•œ ë°ì´í„°í”„ë ˆì„
  df_filtered_dongpeo=pd.DataFrame() 
  for i in range(len(dong_codes)):     # df_filtered_dongpeo ë°ì´í„°í”„ë ˆì„ì„ ë§Œë“œëŠ” ê³¼ì •-í–‰ì •ë™ì½”ë“œê°€ dong_codesì— ì¡´ì¬í•  ê²½ìš°, df_dongpeoì˜ ê°’ì„ ë„£ì–´ì¤€ë‹¤. 
    for j in range(len(df_dongpeo)):
      if df_dongpeo['í–‰ì •ë™ì½”ë“œ'][j] == dong_codes[i]:
            df_filtered_dongpeo = df_filtered_dongpeo.append(df_dongpeo.iloc[j])
  df_filtered_dongpeo.reset_index(drop=True, inplace=True)
  df_filtered_dongpeo = df_filtered_dongpeo.reindex(range(len(df_filtered_dongpeo)))

  #ìµœì¢… ë‚˜ì˜¤ëŠ” ë°ì´í„°ëŠ” df_blueë°ì´í„°. ì—¬ê¸°ì— í–‰ì •ë™ ì½”ë“œ, ì´ë¦„, ë™ì¢…ì—…ê³„, ìƒí™œì¸êµ¬ ëª¨ë‘ ë„£ì–´ ë¸”ë£¨ì˜¤ì…˜ í•„í„°ë§ì— ì‚¬ìš©
  df_blue=pd.DataFrame() 

  #df_blueì˜ ì»¬ëŸ¼ë“¤ì„ ë§Œë“¤ì–´ì£¼ê³ , í–‰ì •ë™ì½”ë“œëª…ì€ ë¯¸ë¦¬ ë„£ì–´ì¤€ë‹¤
  df_blue['í–‰ì •ë™ì½”ë“œëª…']=dong_codes 
  df_blue['ì´ìƒí™œì¸êµ¬'] = 0
  df_blue['ë™ì¢…ì—…ê³„ ìˆ˜']= 0
  df_blue['í–‰ì •ë™ëª…']=np.nan

  #df_blueì— ì´ìƒí™œì¸êµ¬, ë™ì¢…ì—…ê³„ ìˆ˜ë¥¼ ë„£ì–´ì£¼ëŠ” ê³¼ì •
  for i in range(len(df_blue)):  
    for j in range(len(df_filtered_dongpeo)):
      if df_filtered_dongpeo['í–‰ì •ë™ì½”ë“œ'][j] == df_blue['í–‰ì •ë™ì½”ë“œëª…'][i]:
              df_blue['ì´ìƒí™œì¸êµ¬'][i] = df_filtered_dongpeo['ì´ìƒí™œì¸êµ¬ìˆ˜'][j]
  for i in range(len(df_blue)):
    df_blue['ë™ì¢…ì—…ê³„ ìˆ˜'][i]=len(filtered_data[filtered_data['í–‰ì •ë™ì½”ë“œ'] == df_blue['í–‰ì •ë™ì½”ë“œëª…'][i]])

  #df_blueì— í–‰ì •ë™ ì½”ë“œê°€ ìˆê³  í–‰ì •ë™ëª…ì´ì—†ìœ¼ë¯€ë¡œ ë„£ì–´ì¤Œ
  for i in range(len(df_filtered_dongpeo)): 
    for j in range(len(df_blue)):
      if df_blue['í–‰ì •ë™ì½”ë“œëª…'][j]==df_filtered_dongpeo['í–‰ì •ë™ì½”ë“œ'][i]:
        df_blue['í–‰ì •ë™ëª…'][j]=df_filtered_dongpeo['ìë©´ë™ëª…'][i]

  #ì§€ìˆ˜ì»¬ëŸ¼ ë§Œë“œëŠ” ì½”ë“œ. ì§€ìˆ˜ = ì´ìƒí™œì¸êµ¬/ë™ì¢…ì—…ê³„ ìˆ˜, ì§€ìˆ˜ê°€ í´ìˆ˜ë¡ ë” ë¸”ë£¨ì˜¤ì…˜
  df_blue['ì§€ìˆ˜']=df_blue['ì´ìƒí™œì¸êµ¬']/df_blue['ë™ì¢…ì—…ê³„ ìˆ˜']  
  df_sorted_blue = df_blue.sort_values(by='ì§€ìˆ˜', ascending=False)
  print('\n\n***â¤ï¸'+ str(final_category_kor) + ' ì—…ì¢…ì˜ ë™ì¢…ì—…ê³„ ëŒ€ë¹„ ì¸êµ¬ê°€ ë§ì€ í–‰ì •ë™ ìƒìœ„ 30ê°œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤â¤ï¸***')
  print(list(df_sorted_blue['í–‰ì •ë™ëª…'].head(30)))
  print('\n\n\n')

  return df_sorted_blue.head(30)


#ê°€ì¤‘ì¹˜ ì ìš© í•¨ìˆ˜
def score_weight():
  print('ğŸ§¡ ì•„ë˜ í•­ëª©ë“¤ì˜ ë²ˆí˜¸ë¥¼ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°ë˜ëŠ” ìˆœì„œëŒ€ë¡œ ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„í•˜ì—¬ ë‚˜ì—´í•´ì£¼ì„¸ìš”.\n')
  print('1. ì ì¬ì†Œë¹„ì ìˆ˜       2. íì—…ë¥        3. ì„ëŒ€ë£Œ       4.ë§¤ì¶œ\n')
  print('ì˜ˆì‹œ: 4,2,3,1')
  weight=input('ì…ë ¥: ')            # ìˆœìœ„ ì…ë ¥ë°›ì•„ weightì— ì €ì¥
  print()

  weight_list=[]

  if ',' not in weight:               # ì‰¼í‘œë¡œ êµ¬ë¶„ ì•ˆí–ˆì„ ê²½ìš° ë‹¤ì‹œ ì…ë ¥ë°›ìŒ
    print('ì‰¼í‘œë¥¼ í¬í•¨í•˜ì—¬ ì…ë ¥í•´ì£¼ì„¸ìš”.\n')
    return score_weight()
    
  else:
    weight_str=weight.split(',')      # ì‰¼í‘œ ê¸°ì¤€ splití•´ì„œ weight_strì— ì €ì¥
    for i in range(len(weight_str)):
      if weight_str[i].isdigit():     # weight_strì— ì €ì¥ëœ ë¬¸ìì—´ë“¤ì´ ì „ë¶€ ìˆ«ìë¼ë©´
        weight_list=np.array(weight_str, dtype=int)      # ì •ìˆ˜í˜•ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ weight_listì— ì €ì¥
      else:
        print('ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. \n')    # weight_strì´ ìˆ«ìê°€ ì•„ë‹ˆë¼ë©´ ë‹¤ì‹œ ì…ë ¥ë°›ìŒ
        return score_weight()
      
      if weight_list[i]<1 or weight_list[i]>4:        # weight_listì˜ ìš”ì†Œê°€ 1ë¶€í„° 4ê¹Œì§€ì˜ ìˆ«ìê°€ ì•„ë‹ˆë¼ë©´ ë‹¤ì‹œ ì…ë ¥ë°›ìŒ
        print('1ë¶€í„° 4ê¹Œì§€ì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\n')
        return score_weight()
        
  return weight_list
  

 # ì ìˆ˜í™” í•¨ìˆ˜                                   
def score(filter,upjong,weight):      # ë§¤ê°œë³€ìˆ˜ëŠ” ë¸”ë£¨ì˜¤ì…˜ í•„í„°ë§ ê±°ì¹œ ë°ì´í„°/ ì—…ì¢…ëª…(ëŒ€ë¶„ë¥˜) / ê°€ì¤‘ì¹˜ì…ë‹ˆë‹¤
  dongs=filter['í–‰ì •ë™ëª…']    # ìœ„ ë¸”ë£¨ì˜¤ì…˜ì—ì„œ í•„í„°ë§ëœ í–‰ì •ë™ë“¤ dongsì— ì €ì¥

  db_df=pd.DataFrame(index=dongs, columns=['ì ì¬ì†Œë¹„ì','íì—…ë¥ ','ì„ëŒ€ë£Œ', 'ë§¤ì¶œ'])   # ê° ë°ì´í„° ì €ì¥í•  ë°ì´í„°í”„ë ˆì„ ìƒì„±
  
  # ì—…ì¢…ì´ ì†Œë§¤ì—…ì´ë©´ ì ì¬ì†Œë¹„ìì˜ ìƒí™œìš©í’ˆ ì»¬ëŸ¼ ì €ì¥
  if upjong == 'ì†Œë§¤ì—…':               
    db_df['ì ì¬ì†Œë¹„ì']=df_customer['ìƒí™œìš©í’ˆ']
    db_df['ì ì¬ì†Œë¹„ì']=db_df['ì ì¬ì†Œë¹„ì'].fillna(db_df['ì ì¬ì†Œë¹„ì'].mean())    # ê²°ì¸¡ì¹˜ëŠ” ê° ì»¬ëŸ¼ì˜ í‰ê· ê°’ìœ¼ë¡œ ì±„ì›ë‹ˆë‹¤

  # ìˆ™ë°•ì—…ì´ë‚˜ ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…ì´ë©´ ì ì¬ì†Œë¹„ìì˜ ì—¬ê°€ ì»¬ëŸ¼ ì €ì¥
  elif upjong == 'ìˆ™ë°•ì—…' or upjong=='ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…':     
    db_df['ì ì¬ì†Œë¹„ì']=df_customer['ì—¬ê°€']
    db_df['ì ì¬ì†Œë¹„ì']=db_df['ì ì¬ì†Œë¹„ì'].fillna(db_df['ì ì¬ì†Œë¹„ì'].mean())

  # ì—…ì¢…ì´ ìŒì‹ì ì´ë©´ ì ì¬ì†Œë¹„ìì˜ ì‹ë£Œí’ˆ ì»¬ëŸ¼ ì €ì¥
  elif upjong == 'ìŒì‹ì ì—…':           
    db_df['ì ì¬ì†Œë¹„ì']=df_customer['ì‹ë£Œí’ˆ']
    db_df['ì ì¬ì†Œë¹„ì']=db_df['ì ì¬ì†Œë¹„ì'].fillna(db_df['ì ì¬ì†Œë¹„ì'].mean())
  
  elif upjong == 'êµìœ¡ ì„œë¹„ìŠ¤ì—…':
    db_df['ì ì¬ì†Œë¹„ì']=df_customer['êµìœ¡']
    db_df['ì ì¬ì†Œë¹„ì']=db_df['ì ì¬ì†Œë¹„ì'].fillna(db_df['ì ì¬ì†Œë¹„ì'].mean())
  
  elif upjong == 'ë³´ê±´ì˜ë£Œì—…':
    db_df['ì ì¬ì†Œë¹„ì']=df_customer['ì˜ë£Œ']
    db_df['ì ì¬ì†Œë¹„ì']=db_df['ì ì¬ì†Œë¹„ì'].fillna(db_df['ì ì¬ì†Œë¹„ì'].mean())

  # ì´ì™¸ì— ì ì¬ì†Œë¹„ì ì»¬ëŸ¼ìœ¼ë¡œ ë¶„ë¥˜í•  ìˆ˜ ì—†ëŠ” ì—…ì¢…ë“¤ì€ ì´ ì†Œë¹„ì ê¸°ì¤€ìœ¼ë¡œ êµ¬í•©ë‹ˆë‹¤
  else:
    db_df['ì ì¬ì†Œë¹„ì']=df_customer['ì´ ê¸ˆì•¡'] 
    db_df['ì ì¬ì†Œë¹„ì']=db_df['ì ì¬ì†Œë¹„ì'].fillna(db_df['ì ì¬ì†Œë¹„ì'].mean())   

  db_df['ì„ëŒ€ë£Œ']=merge_fee_drop      # ì„ëŒ€ë£Œ ë°ì´í„° ì €ì¥
  db_df['ì„ëŒ€ë£Œ']=db_df['ì„ëŒ€ë£Œ'].fillna(np.mean(db_df['ì„ëŒ€ë£Œ']))
  
  db_df['íì—…ë¥ ']=final_closed_drop   # íì—…ë¥  ë°ì´í„° ì €ì¥
  db_df['íì—…ë¥ ']=db_df['íì—…ë¥ '].fillna(np.mean(db_df['íì—…ë¥ ']))

  db_df['ë§¤ì¶œ']=final_sales_drop      # ë§¤ì¶œ ë°ì´í„° ì €ì¥
  db_df['ë§¤ì¶œ']=db_df['ë§¤ì¶œ'].fillna(np.mean(db_df['ë§¤ì¶œ']))

  df_sum=0
  for i in range(4):      # ì ìˆ˜í™”: ê°€ì¤‘ì¹˜ëŠ” 1ìˆœìœ„ëŠ” 40%, 2ìˆœìœ„ëŠ” 30%, 3ìˆœìœ„ëŠ” 20%, 4ìˆœìœ„ëŠ” 10%
    if weight[i]-1==1 or weight[i]-1==2:        # íì—…ë¥ , ì„ëŒ€ë£ŒëŠ” ìˆ˜ê°€ ì‘ì„ìˆ˜ë¡ ë†’ì€ rankë¥¼ ê°–ë„ë¡ í•¨ 
      df_sum+=db_df.iloc[:, weight[i]-1].rank(ascending=True)*(40-(10*i))     # ê° ì»¬ëŸ¼ì— rankë¥¼ ë§¤ê¸°ê³  ê°€ì¤‘ì¹˜ë¥¼ ê³±í•´ì¤€ í›„ ê·¸ ì´í•©ì„ êµ¬í•¨
    else:                   # ì ì¬ì†Œë¹„ì, ë§¤ì¶œì€ ìˆ˜ê°€ í´ìˆ˜ë¡ ë†’ì€ rankë¥¼ ê°–ë„ë¡ í•¨ (ascending=False)
      df_sum+=db_df.iloc[:, weight[i]-1].rank(ascending=False)*(40-(10*i))

  df_sum=df_sum/100

  samescored=df_sum.duplicated(keep=False)          # ë™ì ê°’ ì°¾ê¸°
  samescoresindex=df_sum[samescored].index          # ì–´ëŠ ë™ì´ ë™ì ì„ ê°–ëŠ”ì§€ ì•Œì•„ëƒ„
  
  filterdong=filter.set_index('í–‰ì •ë™ëª…')
  # ì ìˆ˜í™”í•¨ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ë™ì ì¸ ê°’ë„ ì•½ê°„ì˜ ì°¨ë“±ì„ ë‘ê¸° ìœ„í•´ ë¸”ë£¨ì˜¤ì…˜ì—ì„œ ì‚¬ìš©í–ˆë˜ ì§€ìˆ˜ ë¹„êµ
  ssstandard=filterdong.loc[samescoresindex]['ì§€ìˆ˜'].rank()     # ë™ì ì„ ê°–ëŠ” ë™ë“¤ì˜ ë¸”ë£¨ì˜¤ì…˜ ì§€ìˆ˜ì— rankë¥¼ ë§¤ê¹€
  ssstandard=ssstandard/20              # ë¸”ë£¨ì˜¤ì…˜ ì§€ìˆ˜ëŠ” ë™ì ì¸ ë™ë“¤ ì‚¬ì´ì—ë§Œ ìˆœìœ„ì— ì˜í–¥ì„ ë¼ì¹˜ë„ë¡ ìˆ˜ë¥¼ ê°€ê³µ
  sstandard=ssstandard.reindex(df_sum.index)  
  filled_standard=sstandard.fillna(0)       # NaN ê°’ ë¹¼ë©´ ê²°ê³¼ë„ Nanìœ¼ë¡œ ë‚˜ì™€ì„œ ì „ë¶€ 0ìœ¼ë¡œ ì±„ì›Œì¤Œ

  df_sum=df_sum-filled_standard           # ê° ì ìˆ˜ì—ì„œ ë¸”ë£¨ì˜¤ì…˜ ì ìˆ˜ë¥¼ ëºŒ-ë™ì ì¸ í–‰ ê°„ ì°¨ë“±ì´ ìƒê¹€

  return df_sum.sort_values().head(3), db_df    # ìˆœìœ„ê°€ ê°€ì¥ ë†’ì€ ìƒìœ„ 3ê°œ ê°’ ì¶œë ¥



#í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì½”ë“œ
final_category_kor, category_kor, category_code =business_filter()
filtered=bluefilter(category_code, df_bus, df_dongpeo, final_category_kor)
w=score_weight()
result_dongs=score(filtered, category[1], w)     #result_dongs[0]ì€ ìƒìœ„ 3ê°œ ë™, result_dongs[1]ì€ ì „ì²´ ë™ ë°ì´í„°ì…ë‹ˆë‹¤!
i=1
for dong in result_dongs[0].index:
  print(i,'ìˆœìœ„ ë™ì€', dong+'ì…ë‹ˆë‹¤.')      # ì ìˆ˜í™”í•¨ìˆ˜ ê²°ê³¼ ì¶œë ¥
  i=i+1


# ì‹œê°í™”ì— ì“¸ ë°ì´í„°í”„ë ˆì„ ìƒì„±
first_dong=pd.DataFrame(result_dongs[1].loc[result_dongs[0].index[0]])
second_dong=pd.DataFrame(result_dongs[1].loc[result_dongs[0].index[1]])
third_dong=pd.DataFrame(result_dongs[1].loc[result_dongs[0].index[2]])

final_dong = pd.concat([first_dong, second_dong, third_dong],axis=1).transpose()


#ì¶”ê°€ì •ë³´ ì œê³µ(ì •ë³´ ì‹œê°í™”)
while True:
  ans = input('\nâ¤ï¸ ì¶”ì²œ 3ê°œë™ì— ëŒ€í•œ ìœ„ì¹˜ì™€ ì¶”ê°€ ì •ë³´ ì œê³µì„ ì›í•œë‹¤ë©´ 1ì„, ì•„ë‹ˆë©´ 2ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”: ')
  if ans=='1':
    print("\n\nâ¤ï¸ ì¶”ì²œ 3ê°œ ë™ì˜ ì´ìƒí™œì¸êµ¬ì™€ ë™ì¢…ì—…ê³„ ìˆ˜ë¥¼ ë¹„êµí•©ë‹ˆë‹¤.\n")

    dong_compare = pd.DataFrame(columns=filtered.columns)
    threedong = result_dongs[0]
    df_threedong=pd.DataFrame(threedong)
    # threedongì— ìˆëŠ” ê° í–‰ì •ë™ëª…ì„ ìˆœíšŒí•˜ë©´ì„œ ì²˜ë¦¬
    for dong in threedong.index:
        for i in range(len(filtered)):
            if filtered.iloc[i, 3] == dong:
                matching_rows = filtered.iloc[[i]]
                dong_compare = dong_compare.append(matching_rows)
    dong_compare = dong_compare.reset_index(drop=True)

    bar_width = 0.5
    total_peo=np.array(dong_compare['ì´ìƒí™œì¸êµ¬'])
    same_bus=np.array(dong_compare['ë™ì¢…ì—…ê³„ ìˆ˜'])
    dong_name=dong_compare.iloc[:, 3]

    plt.rc('font', family='NanumBarunGothic')
    plt.title('ìƒí™œì¸êµ¬&ë™ì¢…ì—…ê³„ ë¹„êµ ê·¸ë˜í”„')

    # ìƒí™œì¸êµ¬ ê·¸ë˜í”„ ë°”, ê°’ì„ ê·¸ëŒ€ë¡œ ê·¸ë˜í”„í™”í•˜ë©´ ë™ì¢…ì—…ê³„ ìˆ˜ê°€ ê±°ì˜ ë³´ì´ì§€ ì•Šê¸° ë•Œë¬¸ì—, ì ì ˆí•œ ê°’ìœ¼ë¡œ ìƒí™œì¸êµ¬ë¥¼ ë‚˜ëˆ„ì–´ì£¼ì—ˆë‹¤
    b1 = plt.bar(dong_compare.index, total_peo/10000, color='#9BCA3E', label='ìƒí™œì¸êµ¬/10^4') 
    # ë™ì¢…ì—…ê³„ ìˆ˜ ê·¸ë˜í”„ ë°”
    b2 = plt.bar(dong_compare.index, same_bus, color='#66B5D7', label='ë™ì¢…ì—…ê³„ ìˆ˜') 

    plt.xlabel('í–‰ì •ë™ëª…', size = 13)
    plt.xticks(dong_compare.index, labels=dong_name)
    plt.legend()
    plt.show()


    print("\n\nâ¤ï¸ ì¶”ì²œ 3ê°œ ë™ì˜ ì ì¬ì†Œë¹„ì ìˆ˜, íì—…ë¥ , ì„ëŒ€ë£Œ, ë§¤ì¶œì„ ë¹„êµí•©ë‹ˆë‹¤.\n")

    # yì¶• ê°’ ì €ì¥
    ys1 = final_dong['ì ì¬ì†Œë¹„ì'].to_list()
    ys2 = final_dong['íì—…ë¥ '].to_list()
    ys3 = final_dong['ì„ëŒ€ë£Œ'].to_list()
    ys4 = final_dong['ë§¤ì¶œ'].to_list()

    # ê·¸ë˜í”„ ë°°ì—´ ìƒì„±
    fig, axs = plt.subplots(nrows=2, ncols=2, figsize=(8, 8))

    # ê° subplotì— ê·¸ë˜í”„ ê·¸ë¦¬ê¸°
    axs[0, 0].bar(final_dong.index, ys1, width=0.6, color='b')
    axs[0, 0].set_title('ìƒìœ„ 3ê°œ ë™ì˜ ì ì¬ì†Œë¹„ì ìˆ˜ ë¹„êµ')
    axs[0, 1].bar(final_dong.index, ys2, width=0.6, color='b')
    axs[0, 1].set_title('ìƒìœ„ 3ê°œ ë™ì˜ íì—…ë¥  ë¹„êµ')
    axs[1, 0].bar(final_dong.index, ys3, width=0.6, color='b')
    axs[1, 0].set_title('ìƒìœ„ 3ê°œ ë™ì˜ ì„ëŒ€ë£Œ ë¹„êµ')
    axs[1, 1].bar(final_dong.index, ys4, width=0.6, color='b')
    axs[1, 1].set_title('ìƒìœ„ 3ê°œ ë™ì˜ ë§¤ì¶œ ë¹„êµ')

    # ê·¸ë˜í”„ í¬ê¸°, xì¶•, yì¶• ì´ë¦„ ì„¤ì •
    plt.subplots_adjust(wspace=0.3, hspace=0.5)
    for ax in axs.flat:
        ax.set_xlabel('ìƒìœ„ 3ê°œ ë™')
        ax.set_ylabel('ê°’')
        ax.tick_params(axis='x', labelrotation=45) # xì¶• ë¼ë²¨ íšŒì „
    plt.show()
    break
  elif ans=='2':
    print('ë!')
    break
  else:
    print('\nì˜ëª» ì…ë ¥í•˜ì…¨ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”')
